// ---------------------------------------------------------------------------
// int32 ftell( FILE* d )
// ---------------------------------------------------------------------------
#include <os_syscall.h>
#include <rts.h>
// ---------------------------------------------------------------------------
int32 ftell( FILE* d )
{
  int64 offset;
  if( d == NULL ) return -3;
  if( drv_ioctl( d->rid, IOC_POSITION, &offset ) != OSE_OK ) return -1;
  if( offset >= 2147483648ull ) return -2;
  return (int32)offset;
}
// ---------------------------------------------------------------------------
